# ADR-0001: Gatekeeper における SOT（Single Source of Truth）原則と従属性定義

## Status
Accepted（初期上位規範／憲法）

---

## Context

Gatekeeper プロジェクトは、  
設計・意思決定・構造定義における **正本（Single Source of Truth, 以下 SOT）** を  
単一箇所に厳密に集約することを最重要原則とする。

複数のツール、DB、自動化、将来の拡張が存在する前提においても、  
正本が分散・上書き・黙認変更される状態は、  
プロジェクト全体の整合性・再現性・安全性を破壊する。

このため、SOT の所在と、  
それに対するすべての構成要素の **従属関係** を  
実装から独立した上位規範（憲法レベル）として明文化する。

---

## Decision

### 1. SOT の唯一性

- Gatekeeper における SOT は **gatekeeper-sot リポジトリのみ**とする  
- 他のいかなるリポジトリ、DB、生成物、ツールも SOT にはなり得ない  

---

### 2. SOT の更新原則

- gatekeeper-sot の `main` ブランチは **Pull Request 経由でのみ更新可能**とする  
- 直 push は禁止する  
- 承認数は運用上 `approvals = 0` とするが、  
  **PR を経由するという手続きそのものは必須条件**とする  

---

### 3. 従属物の定義

以下はすべて **SOT に従属する存在**と定義する。

- gatekeeper-app
- 将来追加される UI / CLI / 自動化ツール
- DB（キャッシュ、検索、分析、履歴用途を含む）
- 生成物、提案物、インデックス、派生データ

従属物は以下の制約を必ず満たすものとする。

- SOT を **読むことのみ許可**される  
- SOT を **書き換える権限・経路・暗黙的依存を持たない**  

---

### 4. 正本侵害の禁止

以下の行為は **設計的に許されない**。

- SOT と異なる内容を「正」として扱う実装  
- SOT をバイパスする書き込み経路の追加  
- SOT を前提としない判断ロジックの導入  
- 利便性・速度・自動化を理由とした正本分離  
- 実装や運用による **事後的な正当化**  

---

### 5. 例外の扱い

- SOT 原則に対する例外は **原則として存在しない**  
- やむを得ず例外的な対応が発生した場合は、以下を必須とする：
  - 明示的な記録を残すこと  
  - 例外である理由を説明できること  
  - 恒久化しない方針を持つこと  

---

### 6. SOT 原則の改定について

- SOT に関する原則・定義・境界を変更する必要が生じた場合、  
  **既存 ADR を修正することは行わない**
- 改定は、必ず **新しい ADR を追加する形でのみ許可**される
- 新しい ADR には、以下を必ず含める：
  - 改定が必要となった理由  
  - 変更内容  
  - 既存 ADR との関係（上書き／補足／限定）  
  - 想定される影響範囲  
- **実装・運用が ADR に先行することは許されない**

---

## Consequences

- Gatekeeper は利便性よりも **破壊不能性** を最優先とする  
- すべてのツール・DB・自動化は **SOT の下位概念**として扱われる  
- すべての開発・提案・レビューは  
  **「SOT を侵害していないか」** を第一判断基準とする  

---

## Notes

- 本 ADR は実装詳細を規定しない  
- 本 ADR は Gatekeeper プロジェクトにおける  
  **最上位規範（憲法）**として扱う  
